{"is_source_file": true, "format": "Python", "description": "A script for ingesting AWS resource data from an XLSX file into a PostgreSQL database, including ensuring default organization and cloud accounts, and optionally populating daily cost data.", "external_files": ["psycopg", "openpyxl", "psycopg.types.json"], "external_methods": ["psycopg.connect", "load_workbook", "ast.literal_eval", "datetime.fromisoformat", "jsonb"], "published": ["__future__", "argparse", "ast", "os", "sys", "dataclasses.dataclass", "datetime", "timezone", "Decimal", "InvalidOperation", "Path", "Any", "Dict", "Optional", "Tuple", "parse_qsl", "urlencode", "urlparse", "urlunparse", "psycopg", "load_workbook", "Jsonb"], "classes": [{"name": "UpsertCounts", "description": "A dataclass for keeping track of insert, update, and skipped counts during ingestion processes."}], "methods": [{"name": "str _ensure_ssl_and_channel_binding(dsn: str)", "description": "Ensures the DSN string includes Neon-specific sslmode=require and channel_binding=require flags.", "scope": "", "scopeKind": ""}, {"name": "Optional[datetime] _parse_iso_datetime(v: Any)", "description": "Parses ISO-8601 formatted datetime strings, including handling trailing 'Z'.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,str] _parse_tags_cell(v: Any)", "description": "Parses tags data from XLSX cells, supporting dictionary-like strings and comma-separated key-value pairs.", "scope": "", "scopeKind": ""}, {"name": "Optional[Decimal] _to_decimal(v: Any)", "description": "Converts a value to a Decimal if possible, or returns None.", "scope": "", "scopeKind": ""}, {"name": "Tuple[str,bool] _upsert_org(conn: psycopg.Connection, *, name: str, slug: str)", "description": "Performs an upsert (insert or update) for an organization, returning its ID and whether it was inserted.", "scope": "", "scopeKind": ""}, {"name": "Tuple[str,bool] _upsert_cloud_account( conn: psycopg.Connection, *, organization_id: str, provider: str, account_external_id: str, account_name: str, )", "description": "Performs an upsert for a cloud account, returning its ID and whether it was inserted.", "scope": "", "scopeKind": ""}, {"name": "Tuple[UpsertCounts,UpsertCounts] _ingest_aws_xlsx( conn: psycopg.Connection, *, organization_id: str, cloud_account_id: str, provider: str, xlsx_path: Path, populate_daily_costs: bool, )", "description": "Reads an AWS resources XLSX file and ingests resource and cost data into the database.", "scope": "", "scopeKind": ""}, {"name": "int main()", "description": "Main execution function handling argument parsing, establishing database connection, ensuring defaults, and invoking ingestion routines.", "scope": "", "scopeKind": ""}], "calls": ["psycopg.connect", "load_workbook", "_upsert_org", "_upsert_cloud_account", "_ingest_aws_xlsx", "conn.commit"], "search-terms": ["ingest_step2_1.py", "AWS resources XLSX ingestion", "Neon PostgreSQL schema", "resources table", "resource_costs_daily table", "CloudUnify Demo", "cloud accounts", "resource tags parsing", "resource upsert"], "state": 2, "file_id": 43, "knowledge_revision": 127, "git_revision": "bd7be4530a35ef1f8ccf005da8004d59db0275a0", "ctags": [{"_type": "tag", "name": "UpsertCounts", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_step2_1.py", "pattern": "/^class UpsertCounts:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_ensure_ssl_and_channel_binding", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_step2_1.py", "pattern": "/^def _ensure_ssl_and_channel_binding(dsn: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(dsn: str)"}, {"_type": "tag", "name": "_ingest_aws_xlsx", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_step2_1.py", "pattern": "/^def _ingest_aws_xlsx($/", "language": "Python", "typeref": "typename:Tuple[UpsertCounts,UpsertCounts]", "kind": "function", "signature": "( conn: psycopg.Connection, *, organization_id: str, cloud_account_id: str, provider: str, xlsx_path: Path, populate_daily_costs: bool, )"}, {"_type": "tag", "name": "_parse_iso_datetime", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_step2_1.py", "pattern": "/^def _parse_iso_datetime(v: Any) -> Optional[datetime]:$/", "language": "Python", "typeref": "typename:Optional[datetime]", "kind": "function", "signature": "(v: Any)"}, {"_type": "tag", "name": "_parse_tags_cell", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_step2_1.py", "pattern": "/^def _parse_tags_cell(v: Any) -> Dict[str, str]:$/", "language": "Python", "typeref": "typename:Dict[str,str]", "kind": "function", "signature": "(v: Any)"}, {"_type": "tag", "name": "_to_decimal", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_step2_1.py", "pattern": "/^def _to_decimal(v: Any) -> Optional[Decimal]:$/", "language": "Python", "typeref": "typename:Optional[Decimal]", "kind": "function", "signature": "(v: Any)"}, {"_type": "tag", "name": "_upsert_cloud_account", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_step2_1.py", "pattern": "/^def _upsert_cloud_account($/", "language": "Python", "typeref": "typename:Tuple[str,bool]", "kind": "function", "signature": "( conn: psycopg.Connection, *, organization_id: str, provider: str, account_external_id: str, account_name: str, )"}, {"_type": "tag", "name": "_upsert_org", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_step2_1.py", "pattern": "/^def _upsert_org(conn: psycopg.Connection, *, name: str, slug: str) -> Tuple[str, bool]:$/", "language": "Python", "typeref": "typename:Tuple[str,bool]", "kind": "function", "signature": "(conn: psycopg.Connection, *, name: str, slug: str)"}, {"_type": "tag", "name": "inserted", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_step2_1.py", "pattern": "/^    inserted: int = 0$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "UpsertCounts", "scopeKind": "class"}, {"_type": "tag", "name": "main", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_step2_1.py", "pattern": "/^def main() -> int:$/", "language": "Python", "typeref": "typename:int", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "skipped", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_step2_1.py", "pattern": "/^    skipped: int = 0$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "UpsertCounts", "scopeKind": "class"}, {"_type": "tag", "name": "updated", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_step2_1.py", "pattern": "/^    updated: int = 0$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "UpsertCounts", "scopeKind": "class"}], "hash": "be702da4d471bf2ee0ebd553b60fd35d", "format-version": 4, "code-base-name": "BackendAPI", "filename": "BackendAPI/scripts/ingest_step2_1.py", "fields": [{"name": "int inserted", "scope": "UpsertCounts", "scopeKind": "class", "description": "unavailable"}, {"name": "int skipped", "scope": "UpsertCounts", "scopeKind": "class", "description": "unavailable"}, {"name": "int updated", "scope": "UpsertCounts", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"127": "bd7be4530a35ef1f8ccf005da8004d59db0275a0"}]}