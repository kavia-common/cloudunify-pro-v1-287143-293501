{"is_source_file": true, "format": "Python", "description": "This script is a dataset ingestion utility for the CloudUnify Pro project. It processes Excel (.xlsx) files containing resource and recommendation data, performs idempotent upsert operations into a PostgreSQL database, and manages cloud account and organization lookups. It includes functions for reading Excel files, deducing provider info from filenames, and handling database interactions, with detailed comments and modular design.", "external_files": ["psycopyg", "openpyxl", "pandas", "dotenv"], "external_methods": ["load_workbook", "load_dotenv", "parse_qsl", "urlparse", "urlunparse"], "published": ["discover_input_files", "run"], "classes": [{"name": "TableReport", "description": "Data class to track insertion, update, and skipped counts for database table operations."}, {"name": "IngestConfig", "description": "Configuration data class holding ingestion parameters such as organization ID, database connection info, and input directory."}, {"name": "DbCapabilities", "description": "Data class indicating whether the database has certain optional tables and their columns."}], "methods": [{"name": "List[Dict[str,Any]] _read_excel_rows(path: Path)", "description": "Reads rows from an Excel file, using pandas if available, otherwise openpyxl.", "calls": ["_read_excel_rows_pandas", "_read_excel_rows_openpyxl"], "scope": "", "scopeKind": ""}, {"name": "Dict[str,TableReport] _ingest_resources_file( conn: psycopg.Connection, cfg: IngestConfig, dbcaps: DbCapabilities, path: Path, )", "description": "Reads resource data from an Excel file and inserts or updates resources and cost data into the database.", "calls": ["_read_excel_rows", "_provider_from_filename", "_normalize_provider", "_is_missing", "_parse_tags", "_to_decimal_or_none", "_parse_datetime_or_none", "_fetch_one_scalar", "_upsert_resource_costs_daily", "_resource_cost_daily_row_payload"], "scope": "", "scopeKind": ""}, {"name": "TableReport _ingest_recommendations_file(conn: psycopg.Connection, cfg: IngestConfig, path: Path)", "description": "Processes an Excel file with recommendations, inserting or updating into the recommendations table.", "calls": ["_read_excel_rows", "_normalize_provider", "_is_missing", "_stable_recommendation_id", "_fetch_one_scalar", "_now_utc", "_parse_datetime_or_none", "_json", "_upsert_recommendation"], "scope": "", "scopeKind": ""}, {"name": "Tuple[str,bool] _ensure_cloud_account_for_provider( conn: psycopg.Connection, organization_id: str, provider: str, desired_cloud_account_id: Optional[str], account_native_id: Optional[str], account_name: Optional[str], create_lookups: bool, )", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Tuple[str,bool] _ensure_organization( conn: psycopg.Connection, org_id: Optional[str], org_name: Optional[str], org_slug: Optional[str], create_lookups: bool, )", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str _ensure_ssl_and_channel_binding(dsn: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[Any] _fetch_one_scalar(conn: psycopg.Connection, query: str, params: Tuple[Any, ...])", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[Path] _find_db_connection_txt(start: Path)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "List[str] _get_table_columns(conn: psycopg.Connection, table_name: str, schema: str = \"public\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "bool _is_missing(v: Any)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str _normalize_priority(v: Any)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[str] _normalize_provider(v: Any)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str _normalize_state(state: Any)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "datetime _now_utc()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[datetime] _parse_datetime_or_none(v: Any)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[str] _parse_db_connection_txt(text: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Dict[str,str] _parse_tags(s: Any)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[str] _provider_from_filename(name: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "List[Dict[str,Any]] _read_excel_rows_openpyxl(path: Path)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "List[Dict[str,Any]] _read_excel_rows_pandas(path: Path)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Tuple[str,Dict[str,str],int,int] _resolve_org_and_accounts( conn: psycopg.Connection, args: argparse.Namespace, providers_needed: Iterable[str] )", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[Path] _resolve_repo_root(start: Path)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Dict[str,Any] _resource_cost_daily_row_payload( cfg: IngestConfig, internal_resource_id: str, cloud_account_id: str, provider: str, region: str, cost_daily: Decimal, cost_dt: datetime, columns: Sequence[str], )", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str _slugify(s: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str _snake(s: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str _stable_recommendation_id( organization_id: str, provider: str, external_resource_id: Optional[str], recommendation_type: str, description: Optional[str], )", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "bool _table_exists(conn: psycopg.Connection, table_name: str, schema: str = \"public\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[Decimal] _to_decimal_or_none(v: Any)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[bool] _upsert_resource_costs_daily( cur: psycopg.Cursor, table_name: str, columns: Sequence[str], payload: Dict[str, Any], )", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Tuple[List[Path],List[Path]] discover_input_files(input_dir: Path)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "None load_dotenv(*args: Any, **kwargs: Any)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int run()", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["load_dotenv", "sys.exit", "Path.exists", "Path.read_text", "psycopg.connect", "_resolve_repo_root", "_find_db_connection_txt", "_parse_db_connection_txt", "_ensure_ssl_and_channel_binding", "discover_input_files", "_provider_from_filename", "_normalize_provider", "_table_exists", "_get_table_columns", "_resolve_org_and_accounts", "_ingest_resources_file", "_ingest_recommendations_file", "logger.info", "logger.warning", "logger.error", "logger.exception"], "search-terms": ["ingest_datasets", "Excel resource ingestion", "recommendation ingestion", "PostgreSQL upsert", "cloud account lookup", "organization management", "UUID deterministic", "resource_costs_daily"], "state": 2, "file_id": 40, "knowledge_revision": 122, "git_revision": "7091e9ab9e7ffee4a9f98e54370c07175300b4db", "revision_history": [{"117": ""}, {"119": "adefce0979a1182ea86cf43f1298563fa22d1fff"}, {"122": "7091e9ab9e7ffee4a9f98e54370c07175300b4db"}], "ctags": [{"_type": "tag", "name": "DbCapabilities", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^class DbCapabilities:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "FALLBACK_NEON_DSN", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^FALLBACK_NEON_DSN = \"postgresql:\\/\\/USER:PASSWORD@HOST:PORT\\/DBNAME?sslmode=require\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "IngestConfig", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^class IngestConfig:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "NAMESPACE_CLOUD_ACCOUNT", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^NAMESPACE_CLOUD_ACCOUNT = uuid.UUID(\"0cb9f6d1-2b6b-4e25-bc05-7c0a8d1c5fb1\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "NAMESPACE_ORG", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^NAMESPACE_ORG = uuid.UUID(\"a9d8e4a4-9f16-4f6b-a8ef-8c0f8d54cf5a\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "NAMESPACE_RECOMMENDATION", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^NAMESPACE_RECOMMENDATION = uuid.UUID(\"1d4ab8e8-0d5e-4c1a-9a41-2a30f1a34a2c\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "NAMESPACE_RESOURCE_COST_DAILY", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^NAMESPACE_RESOURCE_COST_DAILY = uuid.UUID(\"45dffbda-0f3f-4c9f-a9a9-3fbefb13e531\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "PRIORITY_ALLOWED", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^PRIORITY_ALLOWED = {\"low\", \"medium\", \"high\", \"critical\"}$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "PROVIDER_SLUGS", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^PROVIDER_SLUGS = {\"aws\", \"azure\", \"gcp\"}$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "SQL_FIND_RESOURCE_INTERNAL_ID", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^SQL_FIND_RESOURCE_INTERNAL_ID = \"\"\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "SQL_SELECT_CLOUD_ACCOUNT_BY_ORG_PROVIDER", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^SQL_SELECT_CLOUD_ACCOUNT_BY_ORG_PROVIDER = \"\"\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "SQL_SELECT_CLOUD_ACCOUNT_BY_ORG_PROVIDER_ACCOUNT_ID", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^SQL_SELECT_CLOUD_ACCOUNT_BY_ORG_PROVIDER_ACCOUNT_ID = \"\"\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "SQL_SELECT_ORG_BY_SLUG", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^SQL_SELECT_ORG_BY_SLUG = \"\"\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "SQL_SELECT_ORG_EXISTS", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^SQL_SELECT_ORG_EXISTS = \"\"\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "SQL_UPSERT_CLOUD_ACCOUNT_BY_ID", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^SQL_UPSERT_CLOUD_ACCOUNT_BY_ID = \"\"\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "SQL_UPSERT_ORGANIZATION", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^SQL_UPSERT_ORGANIZATION = \"\"\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "SQL_UPSERT_RECOMMENDATION", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^SQL_UPSERT_RECOMMENDATION = \"\"\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "SQL_UPSERT_RESOURCE", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^SQL_UPSERT_RESOURCE = \"\"\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "TableReport", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^class TableReport:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_ensure_cloud_account_for_provider", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^def _ensure_cloud_account_for_provider($/", "language": "Python", "typeref": "typename:Tuple[str,bool]", "kind": "function", "signature": "( conn: psycopg.Connection, organization_id: str, provider: str, desired_cloud_account_id: Optional[str], account_native_id: Optional[str], account_name: Optional[str], create_lookups: bool, )"}, {"_type": "tag", "name": "_ensure_organization", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^def _ensure_organization($/", "language": "Python", "typeref": "typename:Tuple[str,bool]", "kind": "function", "signature": "( conn: psycopg.Connection, org_id: Optional[str], org_name: Optional[str], org_slug: Optional[str], create_lookups: bool, )"}, {"_type": "tag", "name": "_ensure_ssl_and_channel_binding", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^def _ensure_ssl_and_channel_binding(dsn: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(dsn: str)"}, {"_type": "tag", "name": "_fetch_one_scalar", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^def _fetch_one_scalar(conn: psycopg.Connection, query: str, params: Tuple[Any, ...]) -> Optional/", "language": "Python", "typeref": "typename:Optional[Any]", "kind": "function", "signature": "(conn: psycopg.Connection, query: str, params: Tuple[Any, ...])"}, {"_type": "tag", "name": "_find_db_connection_txt", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^def _find_db_connection_txt(start: Path) -> Optional[Path]:$/", "language": "Python", "typeref": "typename:Optional[Path]", "kind": "function", "signature": "(start: Path)"}, {"_type": "tag", "name": "_get_table_columns", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^def _get_table_columns(conn: psycopg.Connection, table_name: str, schema: str = \"public\") -> Lis/", "language": "Python", "typeref": "typename:List[str]", "kind": "function", "signature": "(conn: psycopg.Connection, table_name: str, schema: str = \"public\")"}, {"_type": "tag", "name": "_ingest_recommendations_file", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^def _ingest_recommendations_file(conn: psycopg.Connection, cfg: IngestConfig, path: Path) -> Tab/", "language": "Python", "typeref": "typename:TableReport", "kind": "function", "signature": "(conn: psycopg.Connection, cfg: IngestConfig, path: Path)"}, {"_type": "tag", "name": "_ingest_resources_file", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^def _ingest_resources_file($/", "language": "Python", "typeref": "typename:Dict[str,TableReport]", "kind": "function", "signature": "( conn: psycopg.Connection, cfg: IngestConfig, dbcaps: DbCapabilities, path: Path, )"}, {"_type": "tag", "name": "_is_missing", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^def _is_missing(v: Any) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(v: Any)"}, {"_type": "tag", "name": "_normalize_priority", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^def _normalize_priority(v: Any) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(v: Any)"}, {"_type": "tag", "name": "_normalize_provider", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^def _normalize_provider(v: Any) -> Optional[str]:$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "function", "signature": "(v: Any)"}, {"_type": "tag", "name": "_normalize_state", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^def _normalize_state(state: Any) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(state: Any)"}, {"_type": "tag", "name": "_now_utc", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^def _now_utc() -> datetime:$/", "language": "Python", "typeref": "typename:datetime", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_parse_datetime_or_none", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^def _parse_datetime_or_none(v: Any) -> Optional[datetime]:$/", "language": "Python", "typeref": "typename:Optional[datetime]", "kind": "function", "signature": "(v: Any)"}, {"_type": "tag", "name": "_parse_db_connection_txt", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^def _parse_db_connection_txt(text: str) -> Optional[str]:$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "function", "signature": "(text: str)"}, {"_type": "tag", "name": "_parse_tags", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^def _parse_tags(s: Any) -> Dict[str, str]:$/", "language": "Python", "typeref": "typename:Dict[str,str]", "kind": "function", "signature": "(s: Any)"}, {"_type": "tag", "name": "_provider_from_filename", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^def _provider_from_filename(name: str) -> Optional[str]:$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "function", "signature": "(name: str)"}, {"_type": "tag", "name": "_read_excel_rows", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^def _read_excel_rows(path: Path) -> List[Dict[str, Any]]:$/", "language": "Python", "typeref": "typename:List[Dict[str,Any]]", "kind": "function", "signature": "(path: Path)"}, {"_type": "tag", "name": "_read_excel_rows_openpyxl", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^def _read_excel_rows_openpyxl(path: Path) -> List[Dict[str, Any]]:$/", "language": "Python", "typeref": "typename:List[Dict[str,Any]]", "kind": "function", "signature": "(path: Path)"}, {"_type": "tag", "name": "_read_excel_rows_pandas", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^def _read_excel_rows_pandas(path: Path) -> List[Dict[str, Any]]:$/", "language": "Python", "typeref": "typename:List[Dict[str,Any]]", "kind": "function", "signature": "(path: Path)"}, {"_type": "tag", "name": "_resolve_org_and_accounts", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^def _resolve_org_and_accounts($/", "language": "Python", "typeref": "typename:Tuple[str,Dict[str,str],int,int]", "kind": "function", "signature": "( conn: psycopg.Connection, args: argparse.Namespace, providers_needed: Iterable[str] )"}, {"_type": "tag", "name": "_resolve_repo_root", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^def _resolve_repo_root(start: Path) -> Optional[Path]:$/", "language": "Python", "typeref": "typename:Optional[Path]", "kind": "function", "signature": "(start: Path)"}, {"_type": "tag", "name": "_resource_cost_daily_row_payload", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^def _resource_cost_daily_row_payload($/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "( cfg: IngestConfig, internal_resource_id: str, cloud_account_id: str, provider: str, region: str, cost_daily: Decimal, cost_dt: datetime, columns: Sequence[str], )"}, {"_type": "tag", "name": "_slugify", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^def _slugify(s: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(s: str)"}, {"_type": "tag", "name": "_snake", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^def _snake(s: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(s: str)"}, {"_type": "tag", "name": "_stable_recommendation_id", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^def _stable_recommendation_id($/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "( organization_id: str, provider: str, external_resource_id: Optional[str], recommendation_type: str, description: Optional[str], )"}, {"_type": "tag", "name": "_table_exists", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^def _table_exists(conn: psycopg.Connection, table_name: str, schema: str = \"public\") -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(conn: psycopg.Connection, table_name: str, schema: str = \"public\")"}, {"_type": "tag", "name": "_to_decimal_or_none", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^def _to_decimal_or_none(v: Any) -> Optional[Decimal]:$/", "language": "Python", "typeref": "typename:Optional[Decimal]", "kind": "function", "signature": "(v: Any)"}, {"_type": "tag", "name": "_upsert_resource_costs_daily", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^def _upsert_resource_costs_daily($/", "language": "Python", "typeref": "typename:Optional[bool]", "kind": "function", "signature": "( cur: psycopg.Cursor, table_name: str, columns: Sequence[str], payload: Dict[str, Any], )"}, {"_type": "tag", "name": "create_lookups", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^    create_lookups: bool = True$/", "language": "Python", "typeref": "typename:bool", "kind": "variable", "scope": "IngestConfig", "scopeKind": "class"}, {"_type": "tag", "name": "discover_input_files", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^def discover_input_files(input_dir: Path) -> Tuple[List[Path], List[Path]]:$/", "language": "Python", "typeref": "typename:Tuple[List[Path],List[Path]]", "kind": "function", "signature": "(input_dir: Path)"}, {"_type": "tag", "name": "dry_run", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^    dry_run: bool = False$/", "language": "Python", "typeref": "typename:bool", "kind": "variable", "scope": "IngestConfig", "scopeKind": "class"}, {"_type": "tag", "name": "handler", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^handler = logging.StreamHandler(sys.stdout)$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "inserted", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^    inserted: int = 0$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "TableReport", "scopeKind": "class"}, {"_type": "tag", "name": "load_dotenv", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^    def load_dotenv(*args: Any, **kwargs: Any) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(*args: Any, **kwargs: Any)"}, {"_type": "tag", "name": "logger", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^logger = logging.getLogger(\"cloudunify.scripts.ingest\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "pd", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^    import pandas as pd  # type: ignore$/", "language": "Python", "kind": "namespace", "nameref": "module:pandas"}, {"_type": "tag", "name": "pd", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^    pd = None  # type: ignore$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "run", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^def run() -> int:$/", "language": "Python", "typeref": "typename:int", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "skipped", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^    skipped: int = 0$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "TableReport", "scopeKind": "class"}, {"_type": "tag", "name": "updated", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/scripts/ingest_datasets.py", "pattern": "/^    updated: int = 0$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "TableReport", "scopeKind": "class"}], "hash": "bf8caa9d96b89e8515cdc92185d10f4d", "format-version": 4, "code-base-name": "BackendAPI", "filename": "BackendAPI/scripts/ingest_datasets.py", "fields": [{"name": "FALLBACK_NEON_DSN = \"postgresql:\\/\\/USER:PASSWORD@HOST:PORT\\/DBNAME?sslmode=require\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "NAMESPACE_CLOUD_ACCOUNT = uuid.UUID(\"0cb9f6d1-2b6b-4e25-bc05-7c0a8d1c5fb1\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "NAMESPACE_ORG = uuid.UUID(\"a9d8e4a4-9f16-4f6b-a8ef-8c0f8d54cf5a\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "NAMESPACE_RECOMMENDATION = uuid.UUID(\"1d4ab8e8-0d5e-4c1a-9a41-2a30f1a34a2c\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "NAMESPACE_RESOURCE_COST_DAILY = uuid.UUID(\"45dffbda-0f3f-4c9f-a9a9-3fbefb13e531\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "PRIORITY_ALLOWED = {\"low\", \"medium\", \"high\", \"critical\"}", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "PROVIDER_SLUGS = {\"aws\", \"azure\", \"gcp\"}", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "SQL_FIND_RESOURCE_INTERNAL_ID = \"\"\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "SQL_SELECT_CLOUD_ACCOUNT_BY_ORG_PROVIDER = \"\"\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "SQL_SELECT_CLOUD_ACCOUNT_BY_ORG_PROVIDER_ACCOUNT_ID = \"\"\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "SQL_SELECT_ORG_BY_SLUG = \"\"\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "SQL_SELECT_ORG_EXISTS = \"\"\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "SQL_UPSERT_CLOUD_ACCOUNT_BY_ID = \"\"\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "SQL_UPSERT_ORGANIZATION = \"\"\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "SQL_UPSERT_RECOMMENDATION = \"\"\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "SQL_UPSERT_RESOURCE = \"\"\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "bool create_lookups", "scope": "IngestConfig", "scopeKind": "class", "description": "unavailable"}, {"name": "bool dry_run", "scope": "IngestConfig", "scopeKind": "class", "description": "unavailable"}, {"name": "handler = logging.StreamHandler(sys.stdout)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int inserted", "scope": "TableReport", "scopeKind": "class", "description": "unavailable"}, {"name": "logger = logging.getLogger(\"cloudunify.scripts.ingest\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "pd = None  # type: ignore", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int skipped", "scope": "TableReport", "scopeKind": "class", "description": "unavailable"}, {"name": "int updated", "scope": "TableReport", "scopeKind": "class", "description": "unavailable"}]}