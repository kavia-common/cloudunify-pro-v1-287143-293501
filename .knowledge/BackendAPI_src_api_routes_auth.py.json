{"is_source_file": true, "format": "Python", "description": "This is a FastAPI route module for authentication-related endpoints, including login, current user info retrieval, and an admin test endpoint. It defines request/response models, route handlers, and depends on database session, security, and user models.", "external_files": ["src/api/db.py", "src/api/models.py", "src/api/security.py"], "external_methods": ["get_session", "verify_password", "create_access_token", "create_refresh_token", "require_roles", "get_current_user"], "published": ["router"], "classes": [{"name": "LoginRequest", "description": "Data model for login request containing user email and password."}, {"name": "LoginResponse", "description": "Data model for the JWT token pair returned upon login."}, {"name": "UserPublic", "description": "Public view model of a user, used for responses."}], "methods": [{"name": "LoginResponse login(payload: LoginRequest, session: AsyncSession = Depends(get_session))", "description": "Handles user authentication, verifies credentials, and returns JWT tokens.", "scope": "", "scopeKind": ""}, {"name": "UserPublic get_me( user=Depends(get_current_user), session: AsyncSession = Depends(get_session), )", "description": "Returns the public profile info of the currently authenticated user.", "scope": "", "scopeKind": ""}, {"name": "admin_ping(_=Depends(require_roles(Role.admin)))", "description": "Admin-only endpoint to verify RBAC permissions.", "scope": "", "scopeKind": ""}], "calls": ["select(User).where(User.email == payload.email)", "session.execute(select(User).where(User.email == payload.email))", "session.execute(select(User).where(User.id == user[\"id\"]))", "verify_password(payload.password, user.hashed_password)", "create_access_token(user_id=user.id, role=user.role)", "create_refresh_token(user_id=user.id, role=user.role)", "get_current_user", "require_roles(Role.admin)"], "search-terms": ["auth.py", "login endpoint", "JWT token", "FastAPI auth routes", "User model", "RBAC", "get_session", "security functions"], "state": 2, "file_id": 19, "knowledge_revision": 50, "git_revision": "06a422bc83e613264740ebb974dc8855dceb4a35", "ctags": [{"_type": "tag", "name": "LoginRequest", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/src/api/routes/auth.py", "pattern": "/^class LoginRequest(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "LoginResponse", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/src/api/routes/auth.py", "pattern": "/^class LoginResponse(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "UserPublic", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/src/api/routes/auth.py", "pattern": "/^class UserPublic(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "access_token", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/src/api/routes/auth.py", "pattern": "/^    access_token: str = Field(..., description=\"Short-lived access token (JWT)\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "LoginResponse", "scopeKind": "class"}, {"_type": "tag", "name": "admin_ping", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/src/api/routes/auth.py", "pattern": "/^async def admin_ping(_=Depends(require_roles(Role.admin))):$/", "language": "Python", "kind": "function", "signature": "(_=Depends(require_roles(Role.admin)))"}, {"_type": "tag", "name": "email", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/src/api/routes/auth.py", "pattern": "/^    email: EmailStr = Field(..., description=\"User email address\")$/", "language": "Python", "typeref": "typename:EmailStr", "kind": "variable", "scope": "LoginRequest", "scopeKind": "class"}, {"_type": "tag", "name": "email", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/src/api/routes/auth.py", "pattern": "/^    email: EmailStr = Field(..., description=\"User email\")$/", "language": "Python", "typeref": "typename:EmailStr", "kind": "variable", "scope": "UserPublic", "scopeKind": "class"}, {"_type": "tag", "name": "get_me", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/src/api/routes/auth.py", "pattern": "/^async def get_me($/", "language": "Python", "typeref": "typename:UserPublic", "kind": "function", "signature": "( user=Depends(get_current_user), session: AsyncSession = Depends(get_session), )"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/src/api/routes/auth.py", "pattern": "/^    id: str = Field(..., description=\"User ID\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "UserPublic", "scopeKind": "class"}, {"_type": "tag", "name": "is_active", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/src/api/routes/auth.py", "pattern": "/^    is_active: bool = Field(..., description=\"Whether the user is active\")$/", "language": "Python", "typeref": "typename:bool", "kind": "variable", "scope": "UserPublic", "scopeKind": "class"}, {"_type": "tag", "name": "login", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/src/api/routes/auth.py", "pattern": "/^async def login(payload: LoginRequest, session: AsyncSession = Depends(get_session)) -> LoginRes/", "language": "Python", "typeref": "typename:LoginResponse", "kind": "function", "signature": "(payload: LoginRequest, session: AsyncSession = Depends(get_session))"}, {"_type": "tag", "name": "password", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/src/api/routes/auth.py", "pattern": "/^    password: str = Field(..., description=\"User password (plaintext)\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "LoginRequest", "scopeKind": "class"}, {"_type": "tag", "name": "refresh_token", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/src/api/routes/auth.py", "pattern": "/^    refresh_token: str = Field(..., description=\"Long-lived refresh token (JWT)\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "LoginResponse", "scopeKind": "class"}, {"_type": "tag", "name": "role", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/src/api/routes/auth.py", "pattern": "/^    role: str = Field(..., description=\"User global role\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "UserPublic", "scopeKind": "class"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/src/api/routes/auth.py", "pattern": "/^router = APIRouter(prefix=\"\\/auth\", tags=[\"Auth\"])$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "token_type", "path": "/home/kavia/workspace/code-generation/cloudunify-pro-v1-287143-293501/BackendAPI/src/api/routes/auth.py", "pattern": "/^    token_type: str = Field(\"bearer\", description=\"Token type (bearer)\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "LoginResponse", "scopeKind": "class"}], "hash": "fcac0ca60210b626c1b784db34fdfa8b", "format-version": 4, "code-base-name": "BackendAPI", "filename": "BackendAPI/src/api/routes/auth.py", "fields": [{"name": "str access_token", "scope": "LoginResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "EmailStr email", "scope": "LoginRequest", "scopeKind": "class", "description": "unavailable"}, {"name": "str id", "scope": "UserPublic", "scopeKind": "class", "description": "unavailable"}, {"name": "bool is_active", "scope": "UserPublic", "scopeKind": "class", "description": "unavailable"}, {"name": "str password", "scope": "LoginRequest", "scopeKind": "class", "description": "unavailable"}, {"name": "str refresh_token", "scope": "LoginResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "str role", "scope": "UserPublic", "scopeKind": "class", "description": "unavailable"}, {"name": "router = APIRouter(prefix=\"\\/auth\", tags=[\"Auth\"])", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str token_type", "scope": "LoginResponse", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"50": "06a422bc83e613264740ebb974dc8855dceb4a35"}]}